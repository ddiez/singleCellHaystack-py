Search.setIndex({"docnames": ["articles", "articles/pbmc3k", "articles/spatial", "articles/toy", "articles/trajectory", "generated/singleCellHaystack.cluster_genes", "generated/singleCellHaystack.haystack", "generated/singleCellHaystack.plot_compare_ranks", "generated/singleCellHaystack.plot_gene_clusters", "generated/singleCellHaystack.plot_pval_hist", "generated/singleCellHaystack.plot_pval_rank", "generated/singleCellHaystack.plot_rand_fit", "index", "pbmc3k", "reference", "spatial", "toy", "trajectory"], "filenames": ["articles.rst", "articles/pbmc3k.ipynb", "articles/spatial.ipynb", "articles/toy.ipynb", "articles/trajectory.ipynb", "generated/singleCellHaystack.cluster_genes.rst", "generated/singleCellHaystack.haystack.rst", "generated/singleCellHaystack.plot_compare_ranks.rst", "generated/singleCellHaystack.plot_gene_clusters.rst", "generated/singleCellHaystack.plot_pval_hist.rst", "generated/singleCellHaystack.plot_pval_rank.rst", "generated/singleCellHaystack.plot_rand_fit.rst", "index.md", "pbmc3k.rst", "reference.rst", "spatial.rst", "toy.rst", "trajectory.rst"], "titles": ["Articles", "Load data", "Load data", "Load toy data", "Load data", "singleCellHaystack.cluster_genes", "singleCellHaystack.haystack", "singleCellHaystack.plot_compare_ranks", "singleCellHaystack.plot_gene_clusters", "singleCellHaystack.plot_pval_hist", "singleCellHaystack.plot_pval_rank", "singleCellHaystack.plot_rand_fit", "singleCellHaystack", "Application to scRNA-seq", "Reference", "Application to spatial transcriptomics", "Toy example", "Application to trajectory analysis"], "terms": {"toi": 0, "exampl": 0, "applic": [0, 12], "scrna": 0, "seq": 0, "spatial": [0, 2, 6], "transcriptom": [0, 12], "trajectori": 0, "analysi": 0, "1": [1, 2, 3, 4, 12], "import": [1, 2, 3, 4, 12], "scanpi": [1, 2, 3, 4, 12], "sc": [1, 2, 3, 4, 12], "singlecellhaystack": [1, 2, 3, 17], "h": [1, 2, 3, 4, 12], "set_figure_param": [1, 3], "facecolor": [1, 3], "white": [1, 3], "dpi": [1, 3], "90": [1, 3, 4], "2": [1, 2, 3, 4], "adata": [1, 2, 3, 4, 5, 8, 12], "dataset": [1, 2, 4], "pbmc3k_process": 1, "100": [1, 2, 3, 4, 5, 6], "23": 1, "5m": 1, "00": [1, 2, 3, 4], "lt": [1, 2, 3, 4], "83": [1, 4], "4mb": 1, "": [1, 2, 3, 4], "anndata": [1, 2, 3, 4, 5, 6], "object": [1, 2, 3, 4, 5, 12], "n_ob": [1, 2, 3, 4], "n_var": [1, 2, 3, 4], "2638": 1, "1838": 1, "ob": [1, 2, 4], "39": [1, 2, 3, 4], "n_gene": [1, 5], "percent_mito": 1, "n_count": 1, "louvain": 1, "var": [1, 2], "n_cell": 1, "un": [1, 2, 4], "draw_graph": 1, "louvain_color": 1, "neighbor": [1, 4], "pca": [1, 4], "rank_genes_group": 1, "obsm": [1, 2, 3], "x_pca": 1, "x_tsne": [1, 3], "x_umap": 1, "x_draw_graph_fr": 1, "varm": 1, "pc": 1, "obsp": 1, "distanc": [1, 2, 3, 4], "connect": 1, "3": [1, 2, 3, 4, 12], "pl": [1, 2, 3, 4], "umap": [1, 4], "color": [1, 2, 3, 4], "user": [1, 2, 4], "diez": [1, 2, 4, 12], "miniconda3": [1, 2, 4], "env": [1, 2, 4], "lib": [1, 2, 4], "python3": [1, 2, 4], "10": [1, 2, 4, 12], "site": [1, 2, 4], "packag": [1, 2, 4, 12], "plot": [1, 3, 4, 7, 9, 10, 11], "_tool": [1, 4], "scatterplot": [1, 4], "py": [1, 2, 4], "392": [1, 4], "userwarn": [1, 2, 4], "No": [1, 4], "colormap": [1, 4], "provid": [1, 4], "via": [1, 4], "c": [1, 4], "paramet": [1, 4, 5, 6, 7, 9, 10, 11], "cmap": [1, 2, 3, 4], "ignor": [1, 4], "cax": [1, 4], "scatter": [1, 3, 4], "4": [1, 2, 3, 4, 8, 12], "re": [1, 2, 3, 4, 12], "raw": 1, "to_adata": 1, "coord": [1, 2, 3, 4, 6], "n_random": [1, 3, 6], "n_genes_to_random": [1, 3, 6], "spline_method": [1, 3, 6], "n": [1, 3], "gt": [1, 2, 3, 4], "start": [1, 2, 3], "enter": [1, 2, 3, 4], "arrai": [1, 2, 3, 4, 6], "method": [1, 2, 3, 4, 5, 12], "scale": [1, 2, 3, 4], "coordin": [1, 2, 3, 4, 6], "calcul": [1, 2, 3, 12, 17], "featur": [1, 2, 3, 4, 6, 12], "std": [1, 2, 3, 4], "remov": [1, 2], "gene": [1, 2, 3, 4, 5, 12], "zero": [1, 2], "varianc": [1, 2], "grid": [1, 2, 3, 4, 12], "point": [1, 2, 3, 4, 12], "cell": [1, 2, 3, 4, 12], "densiti": [1, 2, 3, 4], "q": [1, 2, 3, 4, 12], "dist": [1, 2, 3, 4], "kld": [1, 2, 3, 4], "13713": 1, "02": 1, "5448": 1, "06it": 1, "cv": [1, 2, 3, 4], "select": [1, 2, 3, 4], "random": [1, 2, 3, 4, 11], "35": [1, 3], "19it": 1, "p": [1, 2, 3, 4, 9, 10], "valu": [1, 2, 3, 4, 9, 10], "done": [1, 2, 3, 4], "we": [1, 3, 4], "can": [1, 3, 4, 12], "examin": [1, 3], "some": [1, 3, 12], "first": [1, 3], "fit": [1, 3], "These": [1, 3], "ar": [1, 2, 3, 12], "us": [1, 3, 7, 12], "from": [1, 3, 4, 12], "express": [1, 3, 4, 12], "level": [1, 3], "subset": [1, 3], "order": [1, 3], "estim": [1, 3], "entir": [1, 3], "set": [1, 3, 5], "5": [1, 2, 3], "plot_rand_fit": [1, 2, 3, 4], "mean": [1, 2, 3, 4, 11], "sd": [1, 2, 3, 4, 11], "The": [1, 3, 12], "rank": [1, 3, 7, 10], "logpval": [1, 2, 3, 4, 7], "distribut": [1, 3], "pval": [1, 2, 3, 4], "give": [1, 3], "u": [1, 3], "idea": [1, 3], "how": [1, 3], "mani": [1, 3], "signific": [1, 3], "detect": [1, 3], "6": [1, 2, 3, 4], "plot_pval_rank": [1, 2, 3, 4], "plot_pval_hist": [1, 2, 3, 4], "A": [1, 3, 6, 12], "panda": [1, 3], "datafram": [1, 3], "obtain": [1, 3], "By": [1, 3], "default": [1, 3], "sort": [1, 3, 7], "logpval_adj": [1, 2, 3, 4], "7": [1, 2, 3, 4], "sum": [1, 2, 3, 4], "pval_adj": [1, 2, 3, 4], "12672": 1, "tyrobp": 1, "0": [1, 2, 3, 4, 12], "824173": 1, "599725e": 1, "213": 1, "193703e": 1, "209": 1, "127960e": 1, "208": 1, "658822": 1, "11877": 1, "cst3": 1, "815731": 1, "897961e": 1, "204": 1, "345273e": 1, "200": 1, "034092e": 1, "199": 1, "272030": 1, "1049": 1, "fcer1g": 1, "846571": 1, "201772e": 1, "647989e": 1, "196": 1, "999202e": 1, "195": 1, "783046": 1, "4370": 1, "aif1": 1, "760218": 1, "209666e": 1, "193": 1, "030115e": 1, "189": 1, "926557e": 1, "188": 1, "518541": 1, "4411": 1, "hla": 1, "drb1": 1, "586864": 1, "156285e": 1, "328214e": 1, "925008e": 1, "363691": 1, "12907": 1, "dhx34": 1, "739196": 1, "000000e": [1, 2, 3, 4], "953615e": 1, "50": 1, "000000": [1, 2, 3, 4], "9270": 1, "rp11": 1, "468e2": 1, "422861": 1, "794212e": 1, "52": 1, "10260": 1, "abcc1": 1, "422078": 1, "038303e": 1, "11911": 1, "pxmp4": 1, "590625": 1, "197850e": 1, "3044": 1, "tbccd1": 1, "366168": 1, "431788e": 1, "54": 1, "row": [1, 2, 3, 4], "column": [1, 2, 3, 4, 7], "top": [1, 3, 5], "8": [1, 2, 3], "iloc": [1, 2, 3, 4], "ncol": [1, 2, 3, 4, 8], "spectral_r": [1, 2, 3], "9": [1, 2, 3, 4], "to_csv": [1, 2, 3, 4], "pbmc3k": 1, "tsv": [1, 3], "visium_sg": 2, "50m": 2, "28": 2, "1mb": 2, "26": 2, "9m": 2, "29": [2, 3], "6mb": 2, "_core": 2, "1830": 2, "variabl": 2, "name": 2, "uniqu": 2, "To": 2, "make": 2, "them": 2, "call": 2, "var_names_make_uniqu": 2, "util": 2, "warn_names_dupl": 2, "34": [2, 3], "3798": 2, "36601": 2, "in_tissu": 2, "array_row": 2, "array_col": 2, "gene_id": 2, "feature_typ": 2, "genom": 2, "pp": [2, 4], "normalize_tot": [2, 4], "log1p": [2, 4], "11678": 2, "24923": 2, "11": [2, 12], "2235": 2, "51it": 2, "05": 2, "18": 2, "89it": 2, "8277": 2, "crisp3": 2, "131658": 2, "002692e": 2, "112": 2, "499010e": 2, "108": 2, "111": 2, "998832": 2, "107": 2, "602232": 2, "5157": 2, "cpb1": 2, "052947": 2, "150681e": 2, "031394e": 2, "088806": 2, "106": [2, 4], "692206": 2, "24196": 2, "s100g": 2, "071816": 2, "617157e": 2, "103": 2, "649194e": 2, "98": 2, "102": 2, "179329": 2, "97": 2, "782728": 2, "7116": 2, "cxcl14": 2, "044309": 2, "811847e": 2, "196177e": 2, "054933": 2, "658333": 2, "15913": 2, "slitrk6": 2, "340828": 2, "602061e": 2, "485117e": 2, "101": 2, "584682": 2, "188082": 2, "1851": 2, "al021026": 2, "433165": 2, "995057e": 2, "01": [2, 3, 4], "000215": 2, "825": 2, "ac104170": 2, "796741": 2, "996506e": 2, "000152": 2, "6164": 2, "ac093591": 2, "445691": 2, "997189e": 2, "000122": 2, "10991": 2, "rfx3": 2, "as1": 2, "757526": 2, "997641e": 2, "000102": 2, "14911": 2, "rpl41": 2, "000380": 2, "nan": 2, "csv": [2, 4], "load_toi": 3, "601": 3, "500": 3, "basi": [3, 8], "tsne": 3, "5689": 3, "77it": 3, "69": 3, "84it": 3, "241": 3, "gene_242": 3, "801961": 3, "748949e": 3, "38": 3, "744746e": 3, "36": 3, "775722e": 3, "058253": 3, "274": 3, "gene_275": 3, "738050": 3, "804561e": 3, "902281e": 3, "31": 3, "323623e": 3, "30": 3, "537261": 3, "496": 3, "gene_497": 3, "945970": 3, "162514e": 3, "081257e": 3, "321024e": 3, "511272": 3, "350": 3, "gene_351": 3, "817486": 3, "136079e": 3, "33": 3, "568039e": 3, "250361e": 3, "804643": 3, "338": 3, "gene_339": 3, "730166": 3, "431448e": 3, "215724e": 3, "219169e": 3, "492721": 3, "187": 3, "gene_188": 3, "469387": 3, "999956e": 3, "904205e": 3, "06": 3, "362": 3, "gene_363": 3, "685665": 3, "999987e": 3, "429706e": 3, "07": 3, "447": 3, "gene_448": 3, "526370": 3, "999993e": 3, "903058e": 3, "374": 3, "gene_375": 3, "471640": 3, "999999e": 3, "192371e": 3, "08": 3, "379": 3, "gene_380": 3, "565381": 3, "109075e": 3, "13": 3, "84": 4, "85": 4, "paul15": 4, "warn": 4, "In": 4, "thi": [4, 7, 12], "return": [4, 6], "logarithm": 4, "now": 4, "non": 4, "compat": 4, "_overloaded_dict": 4, "implicitmodificationwarn": 4, "try": 4, "modifi": 4, "attribut": 4, "_un": 4, "view": 4, "initi": 4, "actual": 4, "self": 4, "kei": 4, "contextlib": 4, "142": 4, "futurewarn": 4, "x": [4, 6, 7, 9, 10, 11], "dtype": 4, "being": 4, "convert": 4, "np": 4, "float32": 4, "float64": 4, "next": 4, "version": [4, 12], "convers": 4, "automat": 4, "pass": 4, "explicitli": 4, "avoid": 4, "get": 4, "futur": [4, 12], "behavour": 4, "gen": 4, "2730": 4, "3451": 4, "paul15_clust": 4, "iroot": 4, "86": 4, "tl": 4, "norm": 4, "87": 4, "leiden": 4, "legend_loc": 4, "88": 4, "diffmap": 4, "dpt_pseudotim": 4, "For": 4, "i": [4, 12], "direct": 4, "wai": 4, "access": 4, "pseudotim": [4, 6], "inform": [4, 11], "But": 4, "matrix": [4, 6], "1d": [4, 6], "directli": 4, "89": 4, "numpi": [4, 6], "to_list": 4, "reshap": 4, "027526699": 4, "1844632626": 4, "2824547589": 4, "024467092": 4, "1840169877": 4, "2610832453": 4, "haystack": [4, 12, 13, 15, 16], "var_nam": 4, "1831": 4, "91it": 4, "04": 4, "20": 4, "61it": 4, "91": 4, "92": 4, "93": 4, "2425": 4, "prtn3": 4, "177701": 4, "225502e": 4, "680208e": 4, "652572": 4, "114627": 4, "1121": 4, "fam132a": 4, "351011": 4, "442031e": 4, "532945e": 4, "82": 4, "352418": 4, "81": 4, "814473": 4, "553": 4, "car2": 4, "156820": 4, "025334e": 4, "538429e": 4, "80": 4, "989134": 4, "79": 4, "451190": 4, "815": 4, "ctsg": 4, "217872": 4, "388964e": 4, "514631e": 4, "357638": 4, "78": 4, "819693": 4, "1954": 4, "mt2": 4, "480812": 4, "839566e": 4, "348343e": 4, "77": 4, "735285": 4, "76": 4, "197340": 4, "3409": 4, "zfp217": 4, "192728": 4, "547449e": 4, "020113": 4, "1069": 4, "epx": 4, "444927": 4, "588547e": 4, "018247": 4, "2198": 4, "parp14": 4, "150764": 4, "706013e": 4, "012959": 4, "154": 4, "ak202301": 4, "026495": 4, "771774e": 4, "010027": 4, "3308": 4, "vamp2": 4, "237500": 4, "950423e": 4, "002158": 4, "94": 4, "95": 4, "haystack_result": 5, "kmean": 5, "n_cluster": 5, "none": [5, 6, 7, 8], "random_st": 5, "cluster": [5, 12], "result": [5, 6, 7, 9, 10, 11, 13, 15, 16, 17], "modul": 5, "current": [5, 12], "onli": 5, "sklearn": 5, "implement": [5, 12], "number": [5, 6], "scale_coord": 6, "true": 6, "ngrid_point": 6, "select_genes_randomize_method": 6, "heavytail": 6, "b": 6, "grid_point": 6, "pseudo": 6, "1e": 6, "300": 6, "verbos": 6, "run": [6, 13, 16, 17], "scipi": 6, "spars": 6, "2d": 6, "3d": 6, "an": 6, "embed": 6, "ani": 6, "dimans": 6, "list": [6, 12], "type": [6, 11], "res1": 7, "res2": 7, "sort_bi": 7, "xlabel": 7, "ylabel": 7, "two": 7, "facilit": 7, "compar": 7, "resuot": 7, "what": 7, "label": 7, "axi": 7, "y": 7, "gene_clust": 8, "figsiz": 8, "color_map": 8, "coolwarm": 8, "histogram": 9, "one": 11, "repositori": 12, "contain": 12, "python": 12, "beta": 12, "most": 12, "function": 12, "r": 12, "work": 12, "yet": 12, "avail": 12, "here": 12, "probabl": 12, "imcomplet": 12, "miss": 12, "ad": 12, "weight": 12, "advanc": 12, "formerli": 12, "known": 12, "sampl": 12, "seed": 12, "you": 12, "pypi": 12, "pip": 12, "support": 12, "conda": 12, "read_h5ad": 12, "data": [12, 13, 15, 16, 17], "h5ad": 12, "process": [12, 15], "our": 12, "manuscript": 12, "describ": 12, "updat": 12, "more": 12, "gener": 12, "inclus": 12, "biorxiv": 12, "origin": 12, "wa": 12, "publish": 12, "natur": 12, "commun": 12, "If": 12, "your": 12, "research": 12, "pleas": 12, "cite": 12, "vandenbon": 12, "d": 12, "2020": 12, "independ": 12, "find": 12, "differenti": 12, "singl": 12, "4318": 12, "doi": 12, "1038": 12, "s41467": 12, "020": 12, "17900": 12, "load": [13, 15, 16, 17], "qc": [13, 16], "export": [13, 15, 16, 17], "preprocess": 17, "dpt": 17}, "objects": {"singleCellHaystack": [[5, 0, 1, "", "cluster_genes"], [6, 0, 1, "", "haystack"], [7, 0, 1, "", "plot_compare_ranks"], [8, 0, 1, "", "plot_gene_clusters"], [9, 0, 1, "", "plot_pval_hist"], [10, 0, 1, "", "plot_pval_rank"], [11, 0, 1, "", "plot_rand_fit"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"articl": 0, "load": [1, 2, 3, 4], "data": [1, 2, 3, 4], "run": [1, 3, 4], "haystack": [1, 2, 3, 6], "qc": [1, 3], "result": [1, 2, 3, 4], "export": [1, 2, 3, 4], "process": 2, "toi": [3, 16], "preprocess": 4, "calcul": 4, "dpt": 4, "trajectori": [4, 17], "singlecellhaystack": [4, 5, 6, 7, 8, 9, 10, 11, 12], "cluster_gen": 5, "plot_compare_rank": 7, "plot_gene_clust": 8, "plot_pval_hist": 9, "plot_pval_rank": 10, "plot_rand_fit": 11, "instal": 12, "exampl": [12, 16], "refer": [12, 14], "applic": [13, 15, 17], "scrna": 13, "seq": 13, "spatial": 15, "transcriptom": 15, "analysi": 17}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Articles": [[0, "articles"]], "Load data": [[1, "Load-data"], [2, "Load-data"], [4, "Load-data"]], "Run haystack": [[1, "Run-haystack"], [3, "Run-haystack"]], "QC": [[1, "QC"], [3, "QC"]], "Results": [[1, "Results"], [3, "Results"]], "Export results": [[1, "Export-results"], [2, "Export-results"], [3, "Export-results"], [4, "Export-results"]], "Process": [[2, "Process"]], "Haystack": [[2, "Haystack"]], "Load toy data": [[3, "Load-toy-data"]], "Preprocess": [[4, "Preprocess"]], "Calculate DPT trajectories": [[4, "Calculate-DPT-trajectories"]], "Run singleCellHaystack": [[4, "Run-singleCellHaystack"]], "singleCellHaystack.cluster_genes": [[5, "singlecellhaystack-cluster-genes"]], "singleCellHaystack.haystack": [[6, "singlecellhaystack-haystack"]], "singleCellHaystack.plot_compare_ranks": [[7, "singlecellhaystack-plot-compare-ranks"]], "singleCellHaystack.plot_gene_clusters": [[8, "singlecellhaystack-plot-gene-clusters"]], "singleCellHaystack.plot_pval_hist": [[9, "singlecellhaystack-plot-pval-hist"]], "singleCellHaystack.plot_pval_rank": [[10, "singlecellhaystack-plot-pval-rank"]], "singleCellHaystack.plot_rand_fit": [[11, "singlecellhaystack-plot-rand-fit"]], "singleCellHaystack": [[12, "singlecellhaystack"]], "Installation": [[12, "installation"]], "Example": [[12, "example"]], "References": [[12, "references"]], "Application to scRNA-seq": [[13, "application-to-scrna-seq"]], "Reference": [[14, "reference"]], "Application to spatial transcriptomics": [[15, "application-to-spatial-transcriptomics"]], "Toy example": [[16, "toy-example"]], "Application to trajectory analysis": [[17, "application-to-trajectory-analysis"]]}, "indexentries": {"cluster_genes() (in module singlecellhaystack)": [[5, "singleCellHaystack.cluster_genes"]], "haystack() (in module singlecellhaystack)": [[6, "singleCellHaystack.haystack"]], "plot_compare_ranks() (in module singlecellhaystack)": [[7, "singleCellHaystack.plot_compare_ranks"]], "plot_gene_clusters() (in module singlecellhaystack)": [[8, "singleCellHaystack.plot_gene_clusters"]], "plot_pval_hist() (in module singlecellhaystack)": [[9, "singleCellHaystack.plot_pval_hist"]], "plot_pval_rank() (in module singlecellhaystack)": [[10, "singleCellHaystack.plot_pval_rank"]], "plot_rand_fit() (in module singlecellhaystack)": [[11, "singleCellHaystack.plot_rand_fit"]]}})
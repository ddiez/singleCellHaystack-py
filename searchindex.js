Search.setIndex({"docnames": ["api", "articles", "articles/pbmc3k", "articles/spatial", "articles/toy", "articles/trajectory", "generated/singleCellHaystack.cluster_genes", "generated/singleCellHaystack.haystack", "generated/singleCellHaystack.plot_compare_ranks", "generated/singleCellHaystack.plot_gene_clusters", "generated/singleCellHaystack.plot_pval_hist", "generated/singleCellHaystack.plot_pval_rank", "generated/singleCellHaystack.plot_rand_fit", "index", "pbmc3k", "spatial", "toy", "trajectory"], "filenames": ["api.rst", "articles.rst", "articles/pbmc3k.ipynb", "articles/spatial.ipynb", "articles/toy.ipynb", "articles/trajectory.ipynb", "generated/singleCellHaystack.cluster_genes.rst", "generated/singleCellHaystack.haystack.rst", "generated/singleCellHaystack.plot_compare_ranks.rst", "generated/singleCellHaystack.plot_gene_clusters.rst", "generated/singleCellHaystack.plot_pval_hist.rst", "generated/singleCellHaystack.plot_pval_rank.rst", "generated/singleCellHaystack.plot_rand_fit.rst", "index.md", "pbmc3k.rst", "spatial.rst", "toy.rst", "trajectory.rst"], "titles": ["API", "Articles", "Load data", "Load data", "Load toy data", "Load data", "singleCellHaystack.cluster_genes", "singleCellHaystack.haystack", "singleCellHaystack.plot_compare_ranks", "singleCellHaystack.plot_gene_clusters", "singleCellHaystack.plot_pval_hist", "singleCellHaystack.plot_pval_rank", "singleCellHaystack.plot_rand_fit", "singleCellHaystack", "Application to scRNA-seq", "Application to spatial transcriptomics", "Toy example", "Application to trajectory analysis"], "terms": {"toi": 1, "exampl": 1, "applic": [1, 13], "scrna": 1, "seq": 1, "spatial": [1, 3, 7], "transcriptom": [1, 13], "trajectori": 1, "analysi": 1, "1": [2, 3, 4, 5, 13], "import": [2, 3, 4, 5, 13], "scanpi": [2, 3, 4, 5, 13], "sc": [2, 3, 4, 5, 13], "singlecellhaystack": [2, 3, 4, 17], "h": [2, 3, 4, 5, 13], "set_figure_param": [2, 4], "facecolor": [2, 4], "white": [2, 4], "dpi": [2, 4], "90": [2, 4, 5], "2": [2, 3, 4, 5], "adata": [2, 3, 4, 5, 6, 9, 13], "dataset": [2, 3, 5], "pbmc3k_process": 2, "100": [2, 3, 4, 5, 6, 7], "23": 2, "5m": 2, "00": [2, 3, 4, 5], "lt": [2, 3, 4, 5], "83": [2, 5], "4mb": 2, "": [2, 3, 4, 5], "anndata": [2, 3, 4, 5, 6, 7], "object": [2, 3, 4, 5, 6, 13], "n_ob": [2, 3, 4, 5], "n_var": [2, 3, 4, 5], "2638": 2, "1838": 2, "ob": [2, 3, 5], "39": [2, 3, 4, 5], "n_gene": [2, 6], "percent_mito": 2, "n_count": 2, "louvain": 2, "var": [2, 3], "n_cell": 2, "un": [2, 3, 5], "draw_graph": 2, "louvain_color": 2, "neighbor": [2, 5], "pca": [2, 5], "rank_genes_group": 2, "obsm": [2, 3, 4], "x_pca": 2, "x_tsne": [2, 4], "x_umap": 2, "x_draw_graph_fr": 2, "varm": 2, "pc": 2, "obsp": 2, "distanc": [2, 3, 4, 5], "connect": 2, "3": [2, 3, 4, 5, 13], "pl": [2, 3, 4, 5], "umap": [2, 5], "color": [2, 3, 4, 5], "user": [2, 3, 5], "diez": [2, 3, 5, 13], "miniconda3": [2, 3, 5], "env": [2, 3, 5], "lib": [2, 3, 5], "python3": [2, 3, 5], "10": [2, 3, 5, 13], "site": [2, 3, 5], "packag": [2, 3, 5, 13], "plot": [2, 4, 5, 8, 10, 11, 12], "_tool": [2, 5], "scatterplot": [2, 5], "py": [2, 3, 5], "392": [2, 5], "userwarn": [2, 3, 5], "No": [2, 5], "colormap": [2, 5], "provid": [2, 5], "via": [2, 5], "c": [2, 5], "paramet": [2, 5, 6, 7, 8, 10, 11, 12], "cmap": [2, 3, 4, 5], "ignor": [2, 5], "cax": [2, 5], "scatter": [2, 4, 5], "4": [2, 3, 4, 5, 9, 13], "re": [2, 3, 4, 5, 13], "raw": 2, "to_adata": 2, "coord": [2, 3, 4, 5, 7], "n_random": [2, 4, 7], "n_genes_to_random": [2, 4, 7], "spline_method": [2, 4, 7], "n": [2, 4], "gt": [2, 3, 4, 5], "start": [2, 3, 4], "enter": [2, 3, 4, 5], "arrai": [2, 3, 4, 5, 7], "method": [2, 3, 4, 5, 6, 13], "scale": [2, 3, 4, 5], "coordin": [2, 3, 4, 5, 7], "calcul": [2, 3, 4, 13, 17], "featur": [2, 3, 4, 5, 7, 13], "std": [2, 3, 4, 5], "remov": [2, 3], "gene": [2, 3, 4, 5, 6, 13], "zero": [2, 3], "varianc": [2, 3], "grid": [2, 3, 4, 5, 13], "point": [2, 3, 4, 5, 13], "cell": [2, 3, 4, 5, 13], "densiti": [2, 3, 4, 5], "q": [2, 3, 4, 5, 13], "dist": [2, 3, 4, 5], "kld": [2, 3, 4, 5], "13713": 2, "02": 2, "5448": 2, "06it": 2, "cv": [2, 3, 4, 5], "select": [2, 3, 4, 5], "random": [2, 3, 4, 5, 12], "35": [2, 4], "19it": 2, "p": [2, 3, 4, 5, 10, 11], "valu": [2, 3, 4, 5, 10, 11], "done": [2, 3, 4, 5], "we": [2, 4, 5], "can": [2, 4, 5, 13], "examin": [2, 4], "some": [2, 4, 13], "first": [2, 4], "fit": [2, 4], "These": [2, 4], "ar": [2, 3, 4, 13], "us": [2, 4, 8, 13], "from": [2, 4, 5, 13], "express": [2, 4, 5, 13], "level": [2, 4], "subset": [2, 4], "order": [2, 4], "estim": [2, 4], "entir": [2, 4], "set": [2, 4, 6], "5": [2, 3, 4], "plot_rand_fit": [2, 3, 4, 5], "mean": [2, 3, 4, 5, 12], "sd": [2, 3, 4, 5, 12], "The": [2, 4, 13], "rank": [2, 4, 8, 11], "logpval": [2, 3, 4, 5, 8], "distribut": [2, 4], "pval": [2, 3, 4, 5], "give": [2, 4], "u": [2, 4], "idea": [2, 4], "how": [2, 4], "mani": [2, 4], "signific": [2, 4], "detect": [2, 4], "6": [2, 3, 4, 5], "plot_pval_rank": [2, 3, 4, 5], "plot_pval_hist": [2, 3, 4, 5], "A": [2, 4, 7, 13], "panda": [2, 4], "datafram": [2, 4], "obtain": [2, 4], "By": [2, 4], "default": [2, 4], "sort": [2, 4, 8], "logpval_adj": [2, 3, 4, 5], "7": [2, 3, 4, 5], "sum": [2, 3, 4, 5], "pval_adj": [2, 3, 4, 5], "12672": 2, "tyrobp": 2, "0": [2, 3, 4, 5, 13], "824173": 2, "599725e": 2, "213": 2, "193703e": 2, "209": 2, "127960e": 2, "208": 2, "658822": 2, "11877": 2, "cst3": 2, "815731": 2, "897961e": 2, "204": 2, "345273e": 2, "200": 2, "034092e": 2, "199": 2, "272030": 2, "1049": 2, "fcer1g": 2, "846571": 2, "201772e": 2, "647989e": 2, "196": 2, "999202e": 2, "195": 2, "783046": 2, "4370": 2, "aif1": 2, "760218": 2, "209666e": 2, "193": 2, "030115e": 2, "189": 2, "926557e": 2, "188": 2, "518541": 2, "4411": 2, "hla": 2, "drb1": 2, "586864": 2, "156285e": 2, "328214e": 2, "925008e": 2, "363691": 2, "12907": 2, "dhx34": 2, "739196": 2, "000000e": [2, 3, 4, 5], "953615e": 2, "50": 2, "000000": [2, 3, 4, 5], "9270": 2, "rp11": 2, "468e2": 2, "422861": 2, "794212e": 2, "52": 2, "10260": 2, "abcc1": 2, "422078": 2, "038303e": 2, "11911": 2, "pxmp4": 2, "590625": 2, "197850e": 2, "3044": 2, "tbccd1": 2, "366168": 2, "431788e": 2, "54": 2, "row": [2, 3, 4, 5], "column": [2, 3, 4, 5, 8], "top": [2, 4, 6], "8": [2, 3, 4], "iloc": [2, 3, 4, 5], "ncol": [2, 3, 4, 5, 9], "spectral_r": [2, 3, 4], "9": [2, 3, 4, 5], "to_csv": [2, 3, 4, 5], "pbmc3k": 2, "tsv": [2, 4], "visium_sg": 3, "50m": 3, "28": 3, "1mb": 3, "26": 3, "9m": 3, "29": [3, 4], "6mb": 3, "_core": 3, "1830": 3, "variabl": 3, "name": 3, "uniqu": 3, "To": 3, "make": 3, "them": 3, "call": 3, "var_names_make_uniqu": 3, "util": 3, "warn_names_dupl": 3, "34": [3, 4], "3798": 3, "36601": 3, "in_tissu": 3, "array_row": 3, "array_col": 3, "gene_id": 3, "feature_typ": 3, "genom": 3, "pp": [3, 5], "normalize_tot": [3, 5], "log1p": [3, 5], "11678": 3, "24923": 3, "11": [3, 13], "2235": 3, "51it": 3, "05": 3, "18": 3, "89it": 3, "8277": 3, "crisp3": 3, "131658": 3, "002692e": 3, "112": 3, "499010e": 3, "108": 3, "111": 3, "998832": 3, "107": 3, "602232": 3, "5157": 3, "cpb1": 3, "052947": 3, "150681e": 3, "031394e": 3, "088806": 3, "106": [3, 5], "692206": 3, "24196": 3, "s100g": 3, "071816": 3, "617157e": 3, "103": 3, "649194e": 3, "98": 3, "102": 3, "179329": 3, "97": 3, "782728": 3, "7116": 3, "cxcl14": 3, "044309": 3, "811847e": 3, "196177e": 3, "054933": 3, "658333": 3, "15913": 3, "slitrk6": 3, "340828": 3, "602061e": 3, "485117e": 3, "101": 3, "584682": 3, "188082": 3, "1851": 3, "al021026": 3, "433165": 3, "995057e": 3, "01": [3, 4, 5], "000215": 3, "825": 3, "ac104170": 3, "796741": 3, "996506e": 3, "000152": 3, "6164": 3, "ac093591": 3, "445691": 3, "997189e": 3, "000122": 3, "10991": 3, "rfx3": 3, "as1": 3, "757526": 3, "997641e": 3, "000102": 3, "14911": 3, "rpl41": 3, "000380": 3, "nan": 3, "csv": [3, 5], "load_toi": 4, "601": 4, "500": 4, "basi": [4, 9], "tsne": 4, "5689": 4, "77it": 4, "69": 4, "84it": 4, "241": 4, "gene_242": 4, "801961": 4, "748949e": 4, "38": 4, "744746e": 4, "36": 4, "775722e": 4, "058253": 4, "274": 4, "gene_275": 4, "738050": 4, "804561e": 4, "902281e": 4, "31": 4, "323623e": 4, "30": 4, "537261": 4, "496": 4, "gene_497": 4, "945970": 4, "162514e": 4, "081257e": 4, "321024e": 4, "511272": 4, "350": 4, "gene_351": 4, "817486": 4, "136079e": 4, "33": 4, "568039e": 4, "250361e": 4, "804643": 4, "338": 4, "gene_339": 4, "730166": 4, "431448e": 4, "215724e": 4, "219169e": 4, "492721": 4, "187": 4, "gene_188": 4, "469387": 4, "999956e": 4, "904205e": 4, "06": 4, "362": 4, "gene_363": 4, "685665": 4, "999987e": 4, "429706e": 4, "07": 4, "447": 4, "gene_448": 4, "526370": 4, "999993e": 4, "903058e": 4, "374": 4, "gene_375": 4, "471640": 4, "999999e": 4, "192371e": 4, "08": 4, "379": 4, "gene_380": 4, "565381": 4, "109075e": 4, "13": 4, "84": 5, "85": 5, "paul15": 5, "warn": 5, "In": 5, "thi": [5, 8, 13], "return": [5, 7], "logarithm": 5, "now": 5, "non": 5, "compat": 5, "_overloaded_dict": 5, "implicitmodificationwarn": 5, "try": 5, "modifi": 5, "attribut": 5, "_un": 5, "view": 5, "initi": 5, "actual": 5, "self": 5, "kei": 5, "contextlib": 5, "142": 5, "futurewarn": 5, "x": [5, 7, 8, 10, 11, 12], "dtype": 5, "being": 5, "convert": 5, "np": 5, "float32": 5, "float64": 5, "next": 5, "version": [5, 13], "convers": 5, "automat": 5, "pass": 5, "explicitli": 5, "avoid": 5, "get": 5, "futur": [5, 13], "behavour": 5, "gen": 5, "2730": 5, "3451": 5, "paul15_clust": 5, "iroot": 5, "86": 5, "tl": 5, "norm": 5, "87": 5, "leiden": 5, "legend_loc": 5, "88": 5, "diffmap": 5, "dpt_pseudotim": 5, "For": 5, "i": [5, 13], "direct": 5, "wai": 5, "access": 5, "pseudotim": [5, 7], "inform": [5, 12], "But": 5, "matrix": [5, 7], "1d": [5, 7], "directli": 5, "89": 5, "numpi": [5, 7], "to_list": 5, "reshap": 5, "027526699": 5, "1844632626": 5, "2824547589": 5, "024467092": 5, "1840169877": 5, "2610832453": 5, "haystack": [5, 13, 14, 15, 16], "var_nam": 5, "1831": 5, "91it": 5, "04": 5, "20": 5, "61it": 5, "91": 5, "92": 5, "93": 5, "2425": 5, "prtn3": 5, "177701": 5, "225502e": 5, "680208e": 5, "652572": 5, "114627": 5, "1121": 5, "fam132a": 5, "351011": 5, "442031e": 5, "532945e": 5, "82": 5, "352418": 5, "81": 5, "814473": 5, "553": 5, "car2": 5, "156820": 5, "025334e": 5, "538429e": 5, "80": 5, "989134": 5, "79": 5, "451190": 5, "815": 5, "ctsg": 5, "217872": 5, "388964e": 5, "514631e": 5, "357638": 5, "78": 5, "819693": 5, "1954": 5, "mt2": 5, "480812": 5, "839566e": 5, "348343e": 5, "77": 5, "735285": 5, "76": 5, "197340": 5, "3409": 5, "zfp217": 5, "192728": 5, "547449e": 5, "020113": 5, "1069": 5, "epx": 5, "444927": 5, "588547e": 5, "018247": 5, "2198": 5, "parp14": 5, "150764": 5, "706013e": 5, "012959": 5, "154": 5, "ak202301": 5, "026495": 5, "771774e": 5, "010027": 5, "3308": 5, "vamp2": 5, "237500": 5, "950423e": 5, "002158": 5, "94": 5, "95": 5, "haystack_result": 6, "kmean": 6, "n_cluster": 6, "none": [6, 7, 8, 9], "random_st": 6, "cluster": [6, 13], "result": [6, 7, 8, 10, 11, 12, 14, 15, 16, 17], "modul": 6, "current": [6, 13], "onli": 6, "sklearn": 6, "implement": [6, 13], "number": [6, 7], "scale_coord": 7, "true": 7, "ngrid_point": 7, "select_genes_randomize_method": 7, "heavytail": 7, "b": 7, "grid_point": 7, "pseudo": 7, "1e": 7, "300": 7, "verbos": 7, "run": [7, 14, 16, 17], "scipi": 7, "spars": 7, "2d": 7, "3d": 7, "an": 7, "embed": 7, "ani": 7, "dimans": 7, "list": [7, 13], "type": [7, 12], "res1": 8, "res2": 8, "sort_bi": 8, "xlabel": 8, "ylabel": 8, "two": 8, "facilit": 8, "compar": 8, "resuot": 8, "what": 8, "label": 8, "axi": 8, "y": 8, "gene_clust": 9, "figsiz": 9, "color_map": 9, "coolwarm": 9, "histogram": 10, "one": 12, "repositori": 13, "contain": 13, "python": 13, "beta": 13, "most": 13, "function": 13, "r": 13, "work": 13, "yet": 13, "avail": 13, "here": 13, "probabl": 13, "imcomplet": 13, "miss": 13, "ad": 13, "weight": 13, "advanc": 13, "formerli": 13, "known": 13, "sampl": 13, "seed": 13, "you": 13, "pypi": 13, "pip": 13, "support": 13, "conda": 13, "read_h5ad": 13, "data": [13, 14, 15, 16, 17], "h5ad": 13, "process": [13, 15], "our": 13, "manuscript": 13, "describ": 13, "updat": 13, "more": 13, "gener": 13, "inclus": 13, "biorxiv": 13, "origin": 13, "wa": 13, "publish": 13, "natur": 13, "commun": 13, "If": 13, "your": 13, "research": 13, "pleas": 13, "cite": 13, "vandenbon": 13, "d": 13, "2020": 13, "independ": 13, "find": 13, "differenti": 13, "singl": 13, "4318": 13, "doi": 13, "1038": 13, "s41467": 13, "020": 13, "17900": 13, "load": [14, 15, 16, 17], "qc": [14, 16], "export": [14, 15, 16, 17], "preprocess": 17, "dpt": 17}, "objects": {"singleCellHaystack": [[6, 0, 1, "", "cluster_genes"], [7, 0, 1, "", "haystack"], [8, 0, 1, "", "plot_compare_ranks"], [9, 0, 1, "", "plot_gene_clusters"], [10, 0, 1, "", "plot_pval_hist"], [11, 0, 1, "", "plot_pval_rank"], [12, 0, 1, "", "plot_rand_fit"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "articl": 1, "load": [2, 3, 4, 5], "data": [2, 3, 4, 5], "run": [2, 4, 5], "haystack": [2, 3, 4, 7], "qc": [2, 4], "result": [2, 3, 4, 5], "export": [2, 3, 4, 5], "process": 3, "toi": [4, 16], "preprocess": 5, "calcul": 5, "dpt": 5, "trajectori": [5, 17], "singlecellhaystack": [5, 6, 7, 8, 9, 10, 11, 12, 13], "cluster_gen": 6, "plot_compare_rank": 8, "plot_gene_clust": 9, "plot_pval_hist": 10, "plot_pval_rank": 11, "plot_rand_fit": 12, "instal": 13, "exampl": [13, 16], "refer": 13, "applic": [14, 15, 17], "scrna": 14, "seq": 14, "spatial": 15, "transcriptom": 15, "analysi": 17}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"API": [[0, "api"]], "Articles": [[1, "articles"]], "Load data": [[2, "Load-data"], [3, "Load-data"], [5, "Load-data"]], "Run haystack": [[2, "Run-haystack"], [4, "Run-haystack"]], "QC": [[2, "QC"], [4, "QC"]], "Results": [[2, "Results"], [4, "Results"]], "Export results": [[2, "Export-results"], [3, "Export-results"], [4, "Export-results"], [5, "Export-results"]], "Process": [[3, "Process"]], "Haystack": [[3, "Haystack"]], "Load toy data": [[4, "Load-toy-data"]], "Preprocess": [[5, "Preprocess"]], "Calculate DPT trajectories": [[5, "Calculate-DPT-trajectories"]], "Run singleCellHaystack": [[5, "Run-singleCellHaystack"]], "singleCellHaystack.cluster_genes": [[6, "singlecellhaystack-cluster-genes"]], "singleCellHaystack.haystack": [[7, "singlecellhaystack-haystack"]], "singleCellHaystack.plot_compare_ranks": [[8, "singlecellhaystack-plot-compare-ranks"]], "singleCellHaystack.plot_gene_clusters": [[9, "singlecellhaystack-plot-gene-clusters"]], "singleCellHaystack.plot_pval_hist": [[10, "singlecellhaystack-plot-pval-hist"]], "singleCellHaystack.plot_pval_rank": [[11, "singlecellhaystack-plot-pval-rank"]], "singleCellHaystack.plot_rand_fit": [[12, "singlecellhaystack-plot-rand-fit"]], "singleCellHaystack": [[13, "singlecellhaystack"]], "Installation": [[13, "installation"]], "Example": [[13, "example"]], "References": [[13, "references"]], "Application to scRNA-seq": [[14, "application-to-scrna-seq"]], "Application to spatial transcriptomics": [[15, "application-to-spatial-transcriptomics"]], "Toy example": [[16, "toy-example"]], "Application to trajectory analysis": [[17, "application-to-trajectory-analysis"]]}, "indexentries": {"cluster_genes() (in module singlecellhaystack)": [[6, "singleCellHaystack.cluster_genes"]], "haystack() (in module singlecellhaystack)": [[7, "singleCellHaystack.haystack"]], "plot_compare_ranks() (in module singlecellhaystack)": [[8, "singleCellHaystack.plot_compare_ranks"]], "plot_gene_clusters() (in module singlecellhaystack)": [[9, "singleCellHaystack.plot_gene_clusters"]], "plot_pval_hist() (in module singlecellhaystack)": [[10, "singleCellHaystack.plot_pval_hist"]], "plot_pval_rank() (in module singlecellhaystack)": [[11, "singleCellHaystack.plot_pval_rank"]], "plot_rand_fit() (in module singlecellhaystack)": [[12, "singleCellHaystack.plot_rand_fit"]]}})